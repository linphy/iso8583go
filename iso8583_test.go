package iso8583

import (
	"fmt"
	//"strconv"
	"bytes"
	"testing"
)

/*交通银行报文域定义*/
var IsoExDefJH = []IsoExDef{
	{64, ISOLFIX | ISODBCD | ISOF0 | ISOLJUST},
	{19, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST},
	{6, ISOLFIX | ISODBCD | ISOF0 | ISOLJUST},
	{12, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[  5]  */
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 10]  */
	{6, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{6, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODBCD | ISOF0 | ISORJUST}, /*  Field[ 15]  */
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 20]  */
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODBCD | ISOF0 | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{2, ISOLFIX | ISODBCD | ISOF0 | ISORJUST}, /*  Field[ 25]  */
	{2, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{1, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST}, /*  Field[ 30]  */
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{11, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST},
	{11, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{37, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST}, /*  Field[ 35]  */
	{104, ISOLV3 | ISODBCD | ISOF0 | ISOLJUST},
	{12, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{6, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{2, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 40]  */
	{8, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{15, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{40, ISOLFIX | ISODASC | ISOF0 | ISOLJUST},
	{25, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{76, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST}, /*  Field[ 45]  */
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{62, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 50]  */
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{16, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODBCD | ISOF0 | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 55]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{12, ISOLFIX | ISODBCD | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISOLJUST}, /*  Field[ 60]  */
	{29, ISOLV3 | ISODBCD | ISOF0 | ISOLJUST},
	{40, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{228, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST}, /*  Field[ 65]  */
	{1, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{2, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 70]  */
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{6, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 75]  */
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 80]  */
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 85]  */
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{42, ISOLFIX | ISODASC | ISOF0 | ISOLJUST}, /*  Field[ 90]  */
	{1, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{2, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{5, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{7, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{42, ISOLFIX | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 95]  */
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{16, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{25, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST}, /*  Field[100]  */
	{17, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{100, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[105]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[110]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[115]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[120]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[125]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST}}

/*首采联合报文规范*/
var IsoExDefScUnion = []IsoExDef{
	{64, ISOLFIX | ISODASC | ISOF0 | ISOLJUST},
	{19, ISOLV2 | ISODASC | ISOF0 | ISOLJUST},
	{6, ISOLFIX | ISODASC | ISOF0 | ISOLJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[  5]  */
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 10]  */
	{6, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{6, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 15]  */
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 20]  */
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{2, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 25]  */
	{2, ISOLFIX | ISODBCD | ISOF0 | ISORJUST},
	{1, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST}, /*  Field[ 30]  */
	{8, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{37, ISOLV2 | ISODASC | ISOF0 | ISOLJUST}, /*  Field[ 35]  */
	{104, ISOLV3 | ISODBCD | ISOF0 | ISOLJUST},
	{12, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{6, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{2, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 40]  */
	{8, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{15, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{40, ISOLFIX | ISODASC | ISOF0 | ISOLJUST},
	{12, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{76, ISOLV2 | ISODBCD | ISOF0 | ISOLJUST}, /*  Field[ 45]  */
	{8, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{256, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 50]  */
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{13, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{255, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 55]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISOLJUST}, /*  Field[ 60]  */
	{22, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{24, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{63, ISOLV3 | ISODASC | ISOF0 | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST}, /*  Field[ 65]  */
	{1, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{2, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{3, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 70]  */
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{4, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{6, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 75]  */
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 80]  */
	{10, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{12, ISOLFIX | ISODASC | ISOF0 | ISORJUST}, /*  Field[ 85]  */
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{16, ISOLFIX | ISODASC | ISOF0 | ISORJUST},
	{42, ISOLFIX | ISODASC | ISOF0 | ISOLJUST}, /*  Field[ 90]  */
	{1, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{2, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{5, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{7, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{42, ISOLFIX | ISODASC | ISOFSP | ISOLJUST}, /*  Field[ 95]  */
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST},
	{16, ISOLFIX | ISODC_D | ISOF0 | ISORJUST},
	{25, ISOLFIX | ISODASC | ISOFSP | ISOLJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST},
	{11, ISOLV2 | ISODASC | ISOF0 | ISOLJUST}, /*  Field[100]  */
	{17, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{28, ISOLV2 | ISODASC | ISOFSP | ISOLJUST},
	{100, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[105]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[110]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[115]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[120]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{100, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{100, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST}, /*  Field[125]  */
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{999, ISOLV3 | ISODASC | ISOFSP | ISOLJUST},
	{64, ISOLFIX | ISODBIN | ISOF0 | ISOLJUST}}

func TestNewIsoEx(t *testing.T) {
	iso, err := NewIsoEx(0, 0, 0, IsoExDefYL)
	if err != nil {
		t.Fatal("new IsoEx err")
	}
	if iso.bittype != 0 {
		t.Fatal("new IsoEx err")
	}
	//fmt.Println(iso)
}

func TestStr2IsoEx(t *testing.T) {
	fmt.Println("start TestStr2IsoEx")
	iso, err := NewIsoEx(0, 0, 0, IsoExDefYL)
	if err != nil {
		t.Fatal("new IsoEx err")
	}

	data := []byte{0x02, 0x20, 0x70, 0x24, 0x04, 0x80, 0x2c, 0xc0, 0x88, 0x18, 0x19, 0x88,
		0x80, 0x19, 0x10, 0x00, 0x00, 0x04, 0x90, 0x49, 0x60, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x00, 0x10, 0x82, 0x88, 0x80, 0x02, 0x10,
		0x00, 0x33, 0x88, 0x80, 0x19, 0x10, 0x00, 0x00, 0x04, 0x90, 0x49, 0x6d, 0x00, 0x00, 0x00, 0x10, 0x64, 0x12, 0x20, 0x30, 0x31, 0x30, 0x31, 0x30, 0x30,
		0x33, 0x37, 0x32, 0x37, 0x34, 0x37, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x38, 0x38, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x38, 0x31, 0x39, 0x35, 0x34,
		0x31, 0x31, 0x30, 0x30, 0x30, 0x31, 0x30, 0x30, 0x30, 0x31, 0x31, 0x35, 0x36, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x25, 0x00,
		0x00, 0x05, 0x00, 0x12, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
	iso.Str2IsoEx(data)

	data2, err := iso.Iso2StrEx()
	DumpHex(data2)
	if bytes.Compare(data, data2) != 0 {
		t.Fatal("Compare data and data2 failed")
	}
	//fmt.Println(iso)
}

func TestStr2IsoEx2(t *testing.T) {
	fmt.Println("start TestStr2IsoEx2")
	iso, err := NewIsoEx(0, 0, 0, IsoExDefYL)
	if err != nil {
		t.Fatal("new IsoEx err")
	}

	data := []byte{0x02, 0x00, 0x30, 0x20, 0x04, 0x80, 0x20, 0xc0, 0x80, 0x11, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x75, 0x00, 0x00, 0x00, 0x26, 0x02, 0x20, 0x00, 0x16, 0x99, 0x95, 0x55, 0x21, 0x42, 0x36, 0x42, 0x97, 0x38, 0x38, 0x37, 0x37, 0x37,
		0x37, 0x37, 0x31, 0x38, 0x31, 0x39, 0x35, 0x34, 0x31, 0x31, 0x30, 0x30, 0x30, 0x31, 0x30, 0x30, 0x30, 0x34, 0x31, 0x35, 0x36, 0x00, 0x08, 0x22, 0x00,
		0x19, 0x12, 0x45, 0x42, 0x38, 0x45, 0x42, 0x46, 0x33, 0x30}
	iso.Str2IsoEx(data)

	data2, err := iso.Iso2StrEx()
	DumpHex(data2)
	if bytes.Compare(data, data2) != 0 {
		t.Fatal("Compare data and data2 failed")
	}
	//fmt.Println(iso)
}

func TestStr2IsoEx3(t *testing.T) {
	fmt.Println("start TestStr2IsoEx3")
	iso, err := NewIsoEx(0, 0, 0, IsoExDefYL)
	if err != nil {
		t.Fatal("new IsoEx err")
	}

	data := []byte{0x60, 0x82, 0xdd, 0x03, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x10, 0x70, 0x3e, 0x00, 0x81, 0x0a, 0xd0, 0x84, 0x12, 0x19, 0x88, 0x80, 0x19,
		0x10, 0x04, 0x00, 0x36, 0x95, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x01, 0x63, 0x63, 0x09, 0x51, 0x49, 0x11, 0x29, 0x13,
		0x11, 0x11, 0x29, 0x00, 0x08, 0x80, 0x19, 0x00, 0x00, 0x31, 0x31, 0x32, 0x39, 0x30, 0x30, 0x35, 0x33, 0x33, 0x38, 0x32, 0x38, 0x30, 0x30, 0x30, 0x34,
		0x31, 0x38, 0x34, 0x32, 0x37, 0x39, 0x34, 0x31, 0x38, 0x31, 0x31, 0x30, 0x31, 0x35, 0x34, 0x31, 0x31, 0x33, 0x34, 0x35, 0x38, 0x19, 0x38, 0x30, 0x31,
		0x39, 0x30, 0x30, 0x30, 0x30, 0x20, 0x20, 0x20, 0x38, 0x30, 0x31, 0x39, 0x30, 0x30, 0x30, 0x30, 0x31, 0x35, 0x36, 0x00, 0x20, 0x30, 0x32, 0x31, 0x30,
		0x31, 0x35, 0x36, 0x43, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x00, 0x08, 0x22, 0x00, 0x64, 0x69, 0x00, 0x23, 0x43,
		0x55, 0x50, 0xd6, 0xd0, 0xd0, 0xc0, 0x20, 0x20, 0xd3, 0xe0, 0xb6, 0xee, 0x30, 0x2e, 0x30, 0x30, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20}
	iso.Str2IsoEx(data[11:])

	data2, err := iso.Iso2StrEx()
	DumpHex(data2)
	if bytes.Compare(data[11:], data2) != 0 {
		t.Fatal("Compare data and data2 failed")
	}
	//fmt.Println(iso)
}

func TestStr2IsoExJH(t *testing.T) {
	fmt.Println("start TestStr2IsoExJH")
	iso, err := NewIsoEx(0, 0, 0, IsoExDefJH)
	if err != nil {
		t.Fatal("new IsoEx err")
	}

	data := []byte{0x60, 0x00, 0x00, 0x00, 0x13, 0x04, 0x00, 0x70, 0x38, 0x04, 0x81, 0xa8, 0xc0, 0x80, 0x15, 0x19, 0x88, 0x80, 0x19, 0x10, 0x00, 0x00, 0x79, 0x68, 0x68,
		0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x55, 0x00, 0x52, 0x24, 0x11, 0x51, 0x35, 0x11, 0x29, 0x00, 0x20, 0x00, 0x08, 0x10, 0x00, 0x00,
		0x01, 0x08, 0x30, 0x00, 0x00, 0x13, 0x33, 0x88, 0x80, 0x19, 0x10, 0x00, 0x00, 0x79, 0x68, 0x68, 0x4d, 0x00, 0x00, 0x00, 0x13, 0x70, 0x20, 0x20, 0x32,
		0x30, 0x31, 0x33, 0x30, 0x37, 0x36, 0x37, 0x30, 0x36, 0x34, 0x33, 0x31, 0x30, 0x30, 0x30, 0x34, 0x31, 0x35, 0x38, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x35, 0x34, 0x31, 0x31, 0x30, 0x34, 0x33, 0x31, 0x31, 0x35, 0x36, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x58, 0x34, 0x32, 0x42, 0x43, 0x4d, 0x50,
		0x30, 0x30, 0x36, 0x00, 0x12, 0x30, 0x30, 0x30, 0x30, 0x34, 0x39, 0x30, 0x30, 0x35, 0x32, 0x32, 0x34, 0x45, 0x24, 0x02, 0xdd, 0xcd, 0xcf, 0x52, 0x2c}
	iso.Str2IsoEx(data[5:])

	data2, err := iso.Iso2StrEx()
	DumpHex(data2)
	if bytes.Compare(data[5:], data2) != 0 {
		t.Fatal("Compare data and data2 failed")
	}
	//fmt.Println(iso)
}

func TestStr2IsoExSC(t *testing.T) {
	fmt.Println("start TestStr2IsoExSC")
	defer func() {
		if r := recover(); r != nil {
			fmt.Println("Recovered in f", r)
		}
	}()
	iso, err := NewIsoEx(1, 0, 1, IsoExDefScUnion)
	if err != nil {
		t.Fatal("new IsoEx err")
	}

	data := []byte{0x30, 0x32, 0x30, 0x30, 0xe2, 0x3a, 0x04, 0x81, 0xa0, 0xe0, 0x88, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x41, 0x31, 0x39, 0x38, 0x38, 0x38,
		0x30, 0x31, 0x39, 0x32, 0x30, 0x30, 0x31, 0x30, 0x30, 0x31, 0x36, 0x38, 0x32, 0x32, 0x34, 0x30, 0x33, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x32, 0x32,
		0x36, 0x31, 0x31, 0x31, 0x37, 0x33, 0x36, 0x30, 0x30, 0x30, 0x34, 0x30, 0x30, 0x31, 0x31, 0x31, 0x37, 0x33, 0x36, 0x32, 0x30, 0x31, 0x33, 0x30, 0x32,
		0x32, 0x36, 0x32, 0x30, 0x31, 0x33, 0x30, 0x33, 0x30, 0x33, 0x30, 0x32, 0x31, 0x30, 0x30, 0x31, 0x31, 0x30, 0x39, 0x30, 0x31, 0x31, 0x30, 0x30, 0x30,
		0x00, 0x00, 0x00, 0x31, 0x31, 0x30, 0x39, 0x30, 0x31, 0x31, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0x33, 0x33, 0x38, 0x38, 0x38, 0x30, 0x31, 0x39, 0x32,
		0x30, 0x30, 0x31, 0x30, 0x30, 0x31, 0x36, 0x38, 0x32, 0x32, 0x34, 0x30, 0x3d, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x31, 0x35, 0x39, 0x31, 0x39, 0x32,
		0x31, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x31, 0x30, 0x31, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x36, 0xb1,
		0xb1, 0xbe, 0xa9, 0xca, 0xd7, 0xb2, 0xc9, 0xc1, 0xaa, 0xba, 0xcf, 0xb5, 0xe7, 0xd7, 0xd3, 0xc9, 0xcc, 0xce, 0xf1, 0xd3, 0xd0, 0xcf, 0xde, 0xd4, 0xf0,
		0xc8, 0xce, 0xb9, 0xab, 0xcb, 0xbe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x31, 0x35, 0x36, 0x32, 0x36, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x38, 0x39, 0x30, 0x39, 0x39, 0x30, 0x30, 0x30, 0x32, 0x30, 0x30, 0x36, 0x30, 0x30, 0x31, 0x30,
		0x30, 0x35, 0x3a, 0x5f, 0xa1, 0xbd, 0xbf, 0xf4, 0xf2, 0xdf}
	iso.Str2IsoEx(data)

	data2, err := iso.Iso2StrEx()
	DumpHex(data2)
	if bytes.Compare(data, data2) != 0 {
		t.Fatal("Compare data and data2 failed")
	}
	//fmt.Println(iso)
}
